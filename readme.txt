vlott backend rewrite.

Previous version can be found on branch "legacy".